//
// Created by daw on 4/24/25.
//

#ifndef ZYGISK_IL2CPPDUMPER_HEADER_CONSTANTS_H
#define ZYGISK_IL2CPPDUMPER_HEADER_CONSTANTS_H

#include <iostream>

struct HeaderConstants {
    inline static const std::string GenericHeader =
            "typedef void(*Il2CppMethodPointer)();\n"
            "\n"
            "struct MethodInfo;\n"
            "\n"
            "struct VirtualInvokeData\n"
            "{\n"
            "    Il2CppMethodPointer methodPtr;\n"
            "    const MethodInfo* method;\n"
            "};\n"
            "\n"
            "struct Il2CppType\n"
            "{\n"
            "    void* data;\n"
            "    unsigned int bits;\n"
            "};\n"
            "\n"
            "struct Il2CppClass;\n"
            "\n"
            "struct Il2CppObject\n"
            "{\n"
            "    Il2CppClass *klass;\n"
            "    void *monitor;\n"
            "};\n"
            "\n"
            "union Il2CppRGCTXData\n"
            "{\n"
            "    void* rgctxDataDummy;\n"
            "    const MethodInfo* method;\n"
            "    const Il2CppType* type;\n"
            "    Il2CppClass* klass;\n"
            "};\n"
            "\n"
            "struct Il2CppRuntimeInterfaceOffsetPair\n"
            "{\n"
            "    Il2CppClass* interfaceType;\n"
            "    int32_t offset;\n"
            "};";

    inline static const std::string HeaderV29 =
            "\n\nstruct Il2CppClass_1\n"
            "{\n"
            "    void* image;\n"
            "    void* gc_desc;\n"
            "    const char* name;\n"
            "    const char* namespaze;\n"
            "    Il2CppType byval_arg;\n"
            "    Il2CppType this_arg;\n"
            "    Il2CppClass* element_class;\n"
            "    Il2CppClass* castClass;\n"
            "    Il2CppClass* declaringType;\n"
            "    Il2CppClass* parent;\n"
            "    void *generic_class;\n"
            "    void* typeMetadataHandle;\n"
            "    void* interopData;\n"
            "    Il2CppClass* klass;\n"
            "    void* fields;\n"
            "    void* events;\n"
            "    void* properties;\n"
            "    void* methods;\n"
            "    Il2CppClass** nestedTypes;\n"
            "    Il2CppClass** implementedInterfaces;\n"
            "    Il2CppRuntimeInterfaceOffsetPair* interfaceOffsets;\n"
            "};\n"
            "\n"
            "struct Il2CppClass_2\n"
            "{\n"
            "    Il2CppClass** typeHierarchy;\n"
            "    void *unity_user_data;\n"
            "    uint32_t initializationExceptionGCHandle;\n"
            "    uint32_t cctor_started;\n"
            "    uint32_t cctor_finished;\n"
            "    size_t cctor_thread;\n"
            "    void* genericContainerHandle;\n"
            "    uint32_t instance_size;\n"
            "    uint32_t actualSize;\n"
            "    uint32_t element_size;\n"
            "    int32_t native_size;\n"
            "    uint32_t static_fields_size;\n"
            "    uint32_t thread_static_fields_size;\n"
            "    int32_t thread_static_fields_offset;\n"
            "    uint32_t flags;\n"
            "    uint32_t token;\n"
            "    uint16_t method_count;\n"
            "    uint16_t property_count;\n"
            "    uint16_t field_count;\n"
            "    uint16_t event_count;\n"
            "    uint16_t nested_type_count;\n"
            "    uint16_t vtable_count;\n"
            "    uint16_t interfaces_count;\n"
            "    uint16_t interface_offsets_count;\n"
            "    uint8_t typeHierarchyDepth;\n"
            "    uint8_t genericRecursionDepth;\n"
            "    uint8_t rank;\n"
            "    uint8_t minimumAlignment;\n"
            "    uint8_t naturalAligment;\n"
            "    uint8_t packingSize;\n"
            "    uint8_t bitflags1;\n"
            "    uint8_t bitflags2;\n"
            "};\n"
            "\n"
            "struct Il2CppClass\n"
            "{\n"
            "    Il2CppClass_1 _1;\n"
            "    void* static_fields;\n"
            "    Il2CppRGCTXData* rgctx_data;\n"
            "    Il2CppClass_2 _2;\n"
            "    VirtualInvokeData vtable[255];\n"
            "};\n"
            "\n"
            "typedef uintptr_t il2cpp_array_size_t;\n"
            "\ntypedef int32_t il2cpp_array_lower_bound_t;\n"
            "\nstruct Il2CppArrayBounds\n"
            "{\n"
            "    il2cpp_array_size_t length;\n"
            "    il2cpp_array_lower_bound_t lower_bound;\n"
            "};\n"
            "\n"
            "typedef void (*InvokerMethod)(Il2CppMethodPointer, const MethodInfo*, void*, void**, void*);\n"
            "\nstruct MethodInfo\n"
            "{\n"
            "    Il2CppMethodPointer methodPointer;\n"
            "    Il2CppMethodPointer virtualMethodPointer;\n"
            "    InvokerMethod invoker_method;\n"
            "    const char* name;\n"
            "    Il2CppClass *klass;\n"
            "    const Il2CppType *return_type;\n"
            "    const Il2CppType** parameters;\n"
            "    union\n"
            "    {\n"
            "        const Il2CppRGCTXData* rgctx_data;\n"
            "        const void* methodMetadataHandle;\n"
            "    };\n"
            "    union\n"
            "    {\n"
            "        const void* genericMethod;\n"
            "        const void* genericContainerHandle;\n"
            "    };\n"
            "    uint32_t token;\n"
            "    uint16_t flags;\n"
            "    uint16_t iflags;\n"
            "    uint16_t slot;\n"
            "    uint8_t parameters_count;\n"
            "    uint8_t bitflags;\n"
            "};\n";
};

#endif //ZYGISK_IL2CPPDUMPER_HEADER_CONSTANTS_H
